---
title: Vauban - Microservices Architecture
---
flowchart TD
    subgraph Clients["ğŸ‘¥ CLIENTS"]
        Browser["ğŸŒ Browser"]
        SSHClient["ğŸ’» SSH Client"]
        RDPClient["ğŸ–¥ï¸ RDP Client"]
    end

    subgraph Ingress["ğŸ”’ INGRESS LAYER"]
        LB["Load Balancer<br/>(TLS 1.3)"]
    end

    subgraph WebLayer["ğŸ¦€ RUST WEB SERVICES"]
        direction LR
        Web["<b>vauban-web</b><br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ Admin/User Interface<br/>â€¢ REST API<br/>â€¢ Real-time Dashboard<br/>â€¢ WebSockets"]
        Auth["<b>vauban-auth</b><br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ MFA (TOTP/HOTP)<br/>â€¢ SSO (OIDC/SAML)<br/>â€¢ LDAP/AD sync<br/>â€¢ JWT tokens"]
    end

    subgraph CoreServices["ğŸ¦€ RUST CORE SERVICES"]
        direction LR
        RBAC["<b>vauban-rbac</b><br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ Casbin Engine<br/>â€¢ Policy Decision<br/>â€¢ Auth Cache"]
        Vault["<b>vauban-vault</b><br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ Secrets Mgmt<br/>â€¢ Key Rotation<br/>â€¢ HSM Integration"]
        Audit["<b>vauban-audit</b><br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ WORM Storage<br/>â€¢ Session Replay<br/>â€¢ Real-time Alerts"]
    end

    subgraph ProxyServices["ğŸ¦€ RUST PROXY SERVICES"]
        direction LR
        ProxySSH["<b>vauban-proxy-ssh</b><br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ russh<br/>â€¢ Session Recording<br/>â€¢ Command Filtering<br/>â€¢ Key Injection"]
        ProxyRDP["<b>vauban-proxy-rdp</b><br/>â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br/>â€¢ IronRDP<br/>â€¢ Video Capture<br/>â€¢ NLA Support<br/>â€¢ Watermarking"]
    end

    subgraph Messaging["ğŸ“¨ MESSAGING"]
        RobustMQ["RobustMQ"]
    end

    subgraph DataLayer["ğŸ—ï¸ DATA LAYER"]
        direction LR
        PG[("PostgreSQL 18+<br/>(TDE Encrypted)")]
        Valkey[("Valkey<br/>(Sessions/Cache)")]
        S3[("MinIO/S3<br/>(Recordings)")]
    end

    subgraph SecurityLayer["ğŸ” SECURITY LAYER"]
        direction LR
        HVault["HashiCorp Vault"]
        StepCA["step-ca (PKI)"]
    end

    subgraph Targets["ğŸ¯ TARGET ASSETS"]
        direction LR
        LinuxServers["ğŸ§ Linux"]
        WindowsServers["ğŸªŸ Windows"]
        NetworkDevices["ğŸ“¡ Network"]
    end

    %% Client connections
    Clients --> LB

    %% Load Balancer routing
    LB --> Web
    LB --> ProxySSH
    LB --> ProxyRDP

    %% Web layer connections (IPC via Unix pipes)
    Web <-->|"IPC"| Auth
    Web <-->|"IPC"| RBAC
    Web --> PG
    Web --> Valkey

    %% Auth connections
    Auth <-->|"IPC"| RBAC
    Auth --> PG
    Auth --> Valkey

    %% Proxy connections (IPC via Unix pipes)
    ProxySSH <-->|"IPC"| RBAC
    ProxySSH <-->|"IPC"| Vault
    ProxySSH -->|"Events"| RobustMQ
    ProxySSH --> Targets

    ProxyRDP <-->|"IPC"| RBAC
    ProxyRDP <-->|"IPC"| Vault
    ProxyRDP -->|"Events"| RobustMQ
    ProxyRDP --> WindowsServers

    %% Vault connections
    Vault --> HVault
    Vault --> StepCA

    %% Audit connections
    RobustMQ --> Audit
    Audit --> S3
    Audit --> PG

    %% RBAC data
    RBAC --> PG
    RBAC --> Valkey

    %% Styling
    classDef rustWeb fill:#0d6efd,stroke:#0a58ca,color:#fff
    classDef rust fill:#f74c00,stroke:#c23d00,color:#fff
    classDef infra fill:#198754,stroke:#146c43,color:#fff
    classDef client fill:#6c757d,stroke:#495057,color:#fff
    classDef target fill:#ffc107,stroke:#cc9a06,color:#000
    classDef messaging fill:#17a2b8,stroke:#138496,color:#fff

    class Web,Auth rustWeb
    class RBAC,ProxySSH,ProxyRDP,Vault,Audit rust
    class PG,Valkey,S3,HVault,StepCA infra
    class Browser,SSHClient,RDPClient client
    class LinuxServers,WindowsServers,NetworkDevices target
    class RobustMQ messaging
