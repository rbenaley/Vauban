{% extends "base.html" %}

{% block title %}{{ title }} - {{ vauban.brand_name }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@xterm/xterm@5.5.0/css/xterm.min.css">
<link rel="stylesheet" href="/static/css/terminal.css">
{% endblock %}

{% block content %}
<div class="space-y-4" x-data="sshTerminal('{{ session_id }}')">
    <!-- Terminal header -->
    <div class="flex items-center justify-between">
        <div class="flex items-center gap-4">
            <a href="/assets" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                </svg>
            </a>
            <h1 class="text-2xl font-semibold text-gray-900 dark:text-white">{{ title }}</h1>
        </div>
        <div class="flex items-center gap-2">
            <button @click="toggleFullscreen()" class="px-3 py-1.5 text-sm bg-gray-600 hover:bg-gray-700 text-white rounded-md">
                Fullscreen
            </button>
            <button @click="disconnect()" class="px-3 py-1.5 text-sm bg-red-600 hover:bg-red-700 text-white rounded-md">
                Disconnect
            </button>
        </div>
    </div>

    <!-- Terminal status bar -->
    <div class="terminal-status">
        <span class="status-indicator" :class="status"></span>
        <span x-text="statusText"></span>
        <span class="ml-auto text-gray-500">Session: {{ session_id|truncate(8) }}</span>
    </div>

    <!-- Terminal container -->
    <div id="terminal-container" x-ref="container">
        <div id="terminal" x-ref="terminal"></div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<!-- xterm.js and addons - loaded before Alpine initializes the component -->
<script src="https://cdn.jsdelivr.net/npm/@xterm/xterm@5.5.0/lib/xterm.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@xterm/addon-fit@0.10.0/lib/addon-fit.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@xterm/addon-web-links@0.11.0/lib/addon-web-links.min.js"></script>
{% endblock %}
